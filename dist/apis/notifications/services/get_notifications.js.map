{"version":3,"sources":["../source/apis/notifications/services/get_notifications.js"],"names":["getNotificationsByUser","userId","offset","limit","Notifications","userNotifications","find","$or","all","sort","skip","lean","count","notifications","map","notification","undefined"],"mappings":";;;;;;;AAAA;;;;AAEe,eAAeA,sBAAf,CAAsCC,MAAtC,EAA8CC,MAA9C,EAAsDC,KAAtD,EAA6D;AAC1E,QAAMC,aAAa,GAAG,6BAAtB;AAEA,QAAMC,iBAAiB,GAAG,MAAMD,aAAa,CAACE,IAAd,CAAmB;AACjDC,IAAAA,GAAG,EAAE,CAAC;AAAEN,MAAAA;AAAF,KAAD,EAAa;AAAEO,MAAAA,GAAG,EAAE;AAAP,KAAb;AAD4C,GAAnB,EAG7BC,IAH6B,CAGxB,CAAC,CAAC,WAAD,EAAc,MAAd,CAAD,CAHwB,EAI7BC,IAJ6B,CAIxBR,MAAM,IAAI,CAJc,EAK7BC,KAL6B,CAKvBA,KAAK,IAAI,CALc,EAM7BQ,IAN6B,EAAhC;AAOA,SAAO;AACLC,IAAAA,KAAK,EAAE,MAAMR,aAAa,CAACQ,KAAd,CAAoB;AAAEL,MAAAA,GAAG,EAAE,CAAC;AAAEN,QAAAA;AAAF,OAAD,EAAa;AAAEO,QAAAA,GAAG,EAAE;AAAP,OAAb;AAAP,KAApB,CADR;AAELK,IAAAA,aAAa,EAAER,iBAAiB,CAACS,GAAlB,CAAuBC,YAAD,IAAkB;AACrD,UAAI,CAACA,YAAY,CAACd,MAAlB,EAA0B;AACxB,eAAO,EAAE,GAAGc,YAAL;AAAmBd,UAAAA,MAAnB;AAA2BO,UAAAA,GAAG,EAAEQ;AAAhC,SAAP;AACD;;AACD,aAAO,EAAE,GAAGD,YAAL;AAAmBP,QAAAA,GAAG,EAAEQ;AAAxB,OAAP;AACD,KALc;AAFV,GAAP;AASD","sourcesContent":["import NotificationsModel from '../models/notifications';\n\nexport default async function getNotificationsByUser(userId, offset, limit) {\n  const Notifications = NotificationsModel();\n\n  const userNotifications = await Notifications.find({\n    $or: [{ userId }, { all: true }],\n  })\n    .sort([['createdOn', 'desc']])\n    .skip(offset || 0)\n    .limit(limit || 0)\n    .lean();\n  return {\n    count: await Notifications.count({ $or: [{ userId }, { all: true }] }),\n    notifications: userNotifications.map((notification) => {\n      if (!notification.userId) {\n        return { ...notification, userId, all: undefined };\n      }\n      return { ...notification, all: undefined };\n    }),\n  };\n}\n"],"file":"get_notifications.js"}